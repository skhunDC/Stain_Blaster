<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Stain Blaster â€“ Dublin Cleaners</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="h-full relative bg-white overflow-hidden">
  <!-- Start Screen -->
  <div id="startScreen" class="absolute inset-0 flex flex-col items-center justify-center gap-6">
    <button id="playBtn" class="px-6 py-3 bg-emerald-600 text-white text-2xl rounded-xl">Play</button>
    <div class="w-64 bg-stone-200 h-4 rounded">
      <div id="pointsBar" class="h-4 bg-emerald-500 rounded" style="width:0%"></div>
    </div>
  </div>

  <!-- Game Area -->
  <div id="gameArea" class="absolute inset-0 hidden">
    <div id="levelBadge" class="absolute top-2 left-2 px-4 py-1 bg-emerald-700 text-white rounded-full text-xl">Level 1</div>
    <div id="countdown" class="absolute top-2 right-2 text-4xl font-bold text-stone-700">12</div>
  </div>

  <!-- Reward Modal -->
  <div id="rewardModal" class="absolute inset-0 hidden flex flex-col items-center justify-center gap-6 bg-white/90">
    <div id="rewardBox" class="p-8 rounded-2xl text-2xl text-white"></div>
    <img id="qrImage" class="w-48 h-48"/>
    <button id="restartBtn" class="px-6 py-3 bg-emerald-600 text-white rounded-xl">Play Again</button>
  </div>

  <script src="GameLogic.js"></script>
  <script src="Rewards.js"></script>
  <script>
  const gradients = {
    1:'from-emerald-200 to-emerald-400',
    2:'from-emerald-400 to-lime-400',
    3:'from-lime-400 to-yellow-300',
    4:'from-yellow-300 to-yellow-500'
  };

  document.getElementById('playBtn').addEventListener('click', () => {
    startGame(win => {
      handleReward(win, currentLevel, showReward);
    });
  });

  document.getElementById('restartBtn').addEventListener('click', () => {
    document.getElementById('rewardModal').classList.add('hidden');
    document.getElementById('startScreen').classList.remove('hidden');
  });

  function showReward(res){
    const modal = document.getElementById('rewardModal');
    const box   = document.getElementById('rewardBox');
    box.textContent = res.rewardText;
    box.className = 'p-8 rounded-2xl text-2xl text-white bg-gradient-to-br ' + gradients[res.tier];
    const img = document.getElementById('qrImage');
    if(res.qrBlob){
      img.src = 'data:image/png;base64,' + res.qrBlob;
      img.classList.remove('hidden');
    }else{
      img.classList.add('hidden');
    }
    modal.classList.remove('hidden');
  }
  </script>
</body>
</html>
